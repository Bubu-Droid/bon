{
  "desc": "a_n=7a_{n-1}^2+a_{n-2} find remainder of a_{2025!} modulo 43",
  "puid": "Z69E82",
  "source": [
    {
      "AoPS": "https://aops.com/community/c6h3734787p36720144"
    }
  ],
  "tags": [
    "php",
    "nt",
    "periodic"
  ],
  "date": "2025-07-31",
  "hardness": "medium",
  "problem": "\\begin{problem*}{}{}\n  Let $\\{a_n\\}_{n \\geq 0}$ be a sequence defined\n  by $a_0 = 5$, $a_1 = 27$, and \n  \\[\n    a_n\n    = 7a_{n-1}^2 + a_{n-2} \\quad \\forall\\, n \\geq 2.\n  \\]\n  Find the remainder when $a_{2025!}$\n  is divided by $43$.\n\\end{problem*}",
  "solution": [
    "\\begin{soln}\n  Consider all the tuples $(a_n, a_{n+1})$ under modulo\n  $43$, i.e., $(b_n, b_{n+1})$ where $b_n$\n  is the remainder when $a_n$ is divided by $43$.\n  Clearly, there are at most $43^2$\n  different possibilities for $(b_n, b_{n+1})$\n  considering all the remainder pairs.\n\n  Let\n  \\[\n    S = \\{(b_0, b_1), (b_1, b_2), \\ldots, (b_{43^2}, b_{43^2+1})\\}.\n  \\]\n  As $|S| = 43^2 + 1$, by the pigeonhole principle,\n  there exist at least two tuples in $S$ such that\n  \\[\n    (b_i, b_{i+1}) = (b_j, b_{j+1}), \\quad i < j.\n  \\]\n\n  Now note $b_i = b_j$ and $b_{i+1} = b_{j+1}$ implies\n  \\[\n    b_{i+2} \\equiv 7b_{i+1}^2 + b_i\n    \\equiv 7b_{j+1}^2 + b_j \\equiv b_{j+2}\n    \\pmod{43},\n  \\]\n  which implies $b_{i+2} = b_{j+2}$. Therefore\n  \\[\n    (b_i, b_{i+1}) = (b_j, b_{j+1})\n    \\implies (b_{i+1}, b_{i+2})\n    = (b_{j+1}, b_{j+2})\n  .\\]\n  Similarly,\n  \\[\n    (b_{i+1}, b_{i+2}) = (b_{j+1}, b_{j+2})\n    \\implies (b_{i+2}, b_{i+3}) = (b_{j+2}, b_{j+3})\n    \\implies \\cdots \\text{ and so on}.\n  \\]\n\n  Also,\n  \\[\n    (b_i, b_{i+1}) = (b_j, b_{j+1})\n    \\implies (b_{i-1}, b_i) = (b_{j-1}, b_j)\n  \\]\n  as\n  \\[\n    b_{i-1}\n    \\equiv b_{i+1} - 7b_{i}^2 \\equiv b_{j+1} - 7b_j^2\n    \\equiv b_{j-1} \\pmod{43}.\n  \\]\n  Similarly,\n  \\[\n    (b_i, b_{i+1}) = (b_j, b_{j+1})\n    \\implies (b_{i-1}, b_i) = (b_{j-1}, b_j)\n    \\implies \\cdots \\text{ and so on.}\n  \\]\n\n  Therefore we can conclude that\n  \\[\n    b_{n + (j-i)} = b_n \\quad \\forall\\, n \\geq 0\n  \\]\n  Note that $j - i \\leq 43^2 - 0 = 43^2 \\le 2025$\n  which implies $j-i \\mid 2025!$. To finish, note\n  \\[\n    a_{2025!} \\equiv b_{2025!}\n    = b_0 = 5 \\pmod{43}.\\qedhere\n  \\]\n\\end{soln}"
  ]
}
